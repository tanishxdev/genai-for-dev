
# **Setup Gemini API**

## **1. Goal of This Setup**

To avoid writing duplicate code like:

```js
import { GoogleGenAI } from "@google/genai";
const ai = new GoogleGenAI({});
```

in every single example file.

Instead, we create a **single reusable client**:

```
/utils/geminiClient.js
```

After that, all other files can simply do:

```js
import ai from "../utils/geminiClient.js";
```

This keeps the code clean, scalable, and production-friendly.

---

# **2. Folder Structure (Minimum Required)**

```
‚îî‚îÄ‚îÄ üìÅGenAI
    ‚îú‚îÄ‚îÄ üìÅsrc
    ‚îú‚îÄ‚îÄ üìÅutils
    ‚îÇ     ‚îî‚îÄ‚îÄ geminiClient.js   ‚Üê main reusable client
    ‚îî‚îÄ‚îÄ .env
```

---

# **3. The Reusable Gemini Client (Explained Line-by-Line)**

### **File: `/utils/geminiClient.js`**

```js
// geminiClient.js
import { GoogleGenAI } from "@google/genai";
import dotenv from "dotenv";
import path from "path";
import { fileURLToPath } from "url";

// ------------------------------
// 1Ô∏è‚É£ Compute project root path
// ------------------------------
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
// Go one level up from /utils to project root
const rootEnvPath = path.resolve(__dirname, "../.env");

// ------------------------------
// 2Ô∏è‚É£ Load .env explicitly from root
// ------------------------------
dotenv.config({ path: rootEnvPath });

// ------------------------------
// 3Ô∏è‚É£ Validate API Key
// ------------------------------
if (!process.env.GEMINI_API_KEY) {
  console.error("‚ùå GEMINI_API_KEY is missing in .env");
  console.error("Checked:", rootEnvPath);
  process.exit(1);
}

// ------------------------------
// 4Ô∏è‚É£ Create a single AI client
// ------------------------------
const ai = new GoogleGenAI({
  apiKey: process.env.GEMINI_API_KEY,
});

// Reusable export
export default ai;
```

---

# **4. .env Setup**

Your `.env` file (at project root):

```
GEMINI_API_KEY=your_api_key_here
```

Make sure:

* `.env` is at project root
* `.gitignore` includes `.env`
* NEVER commit your API key

---

# **5. How to Use the Client in Any Script**

### Example file: `01.setup-gemini-api.js`

```js
import ai from "../utils/geminiClient.js";

async function main() {
  const response = await ai.models.generateContent({
    model: "gemini-2.5-flash",
    contents: "How does AI work?",
  });

  console.log(response.text());
}

await main();
```

### Notice:

No need to write:

```js
import { GoogleGenAI } from "@google/genai";
const ai = new GoogleGenAI({});
```

You simply import your global AI client:

```
import ai from "../utils/geminiClient.js";
```

---

# **6. Why This Setup Is the Correct Industry Standard**

### **1. No duplicate API setup**

Every file uses the same `ai` client.

### **2. Proper environment variable handling**

Works even if scripts run from different folders.

### **3. Clear error handling**

If API key is missing, app stops with a readable error.

### **4. Scalable**

Later you can add:

* Logging wrapper
* Retry logic
* Tracing/Observability
* Guards
* Multi-model configurations

All inside **one file**.

---

# **7. Test Your Setup (Minimal Test File)**

Create `src/01setup-gemini-api.js`

```js
// GOAL: Use reusable Gemini client setup

// Import the pre-configured Gemini client instance
import ai from "../utils/geminiClient.js";

// Async main function to handle API call
async function main() {
  // Send text input to Gemini model and await generated response
  const response = await ai.models.generateContent({
    model: "gemini-2.5-flash",
    contents: "What is OpenAI, in short in short?",
  });

  // Print the text output from the response
  console.log("Response:", response.text);
}

// Run the function
await main();

```

Run:

```
node src/01setup-gemini-api.js
```

If the response prints correctly, your setup is fully working.

---

# **8. All Future Files Will Follow This**

Examples like:

* 02.describe-model.js
* 02a.sampling-control.js
* 03.structured-output.js
* 04.streaming-response.js
* 05.chat-session.js
* 06.tool-calling.js
* 07.github-tool.js
* 09.full-agent.js

All will simply use:

```js
import ai from "../utils/geminiClient.js";
```

No other setup needed again.

---