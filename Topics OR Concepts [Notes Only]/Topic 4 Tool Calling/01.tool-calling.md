# **Topic 4 — Tool Calling (Function Calling in Gemini SDK)**

---

## **1. Concept**

### **What is Tool Calling?**

Tool Calling allows Gemini to:

* **Recognize** when it needs external information.
* **Call your defined JavaScript functions** (tools).
* **Use their results** to form intelligent final responses.

Essentially, you’re teaching Gemini how to **act**, not just respond.

---

### **Example Analogy**

| Situation                              | Without Tool                          | With Tool                                             |
| -------------------------------------- | ------------------------------------- | ----------------------------------------------------- |
| “What’s the current weather in Delhi?” | Model guesses using old training data | Model calls your `getWeather()` function in real time |
| “Fetch Bitcoin price.”                 | Cannot access external API            | Calls your `getCryptoPrice()` function                |
| “Calculate 23 × 76.”                   | Might hallucinate or reason           | Calls `calculate()` directly                          |

---

## **2. How it Works Internally**

1. You define one or more **tools** (functions) with:

   * Name
   * Description
   * Parameter schema

2. Gemini decides **when** to call which tool, based on user prompt.

3. SDK automatically executes that tool and returns result to Gemini.

4. Gemini then uses that result to generate the **final answer**.

---

## **3. Basic Flow Diagram**

```
User → Gemini → [Decides to use Tool] → Tool Function → Returns Data → Gemini → Final Answer
```

---

## **4. Code Example: Function Calling (Tool Use)**

**File:** `src/06.tool-calling.js`

```js
// -------------------------------------------------------------
// GOAL: Demonstrate Function (Tool) Calling with Gemini SDK
// -------------------------------------------------------------
// Concepts:
// - Define tool functions
// - Register tools in config
// - Let model call tools automatically
// -------------------------------------------------------------

import ai from "../utils/geminiClient.js";

// 1️⃣ Define a simple tool (function) with schema and logic
async function getWeather({ location }) {
  // Simulated real-time weather data
  const data = {
    Delhi: "Sunny, 30°C",
    Mumbai: "Cloudy, 28°C",
    Bangalore: "Rainy, 25°C",
  };
  return data[location] || "Weather data not available";
}

// 2️⃣ Define tool metadata (schema + description)
const tools = [
  {
    name: "getWeather",
    description: "Fetches current weather for a given Indian city.",
    parameters: {
      type: "object",
      properties: {
        location: { type: "string", description: "City name" },
      },
      required: ["location"],
    },
    // Link the function
    function: getWeather,
  },
];

// 3️⃣ Create prompt
const prompt = "What is the weather like in Delhi right now?";

// 4️⃣ Call Gemini with tool config
async function main() {
  console.log("Starting tool-calling example...\n");

  const response = await ai.models.generateContent({
    model: "gemini-2.5-flash",
    contents: prompt,
    tools: tools,
  });

  console.log("Response:\n");
  console.log(response.text);
}

await main();
```

---

### **Expected Output**

```
Starting tool-calling example...

Response:
The weather in Delhi is Sunny, 30°C.
```

---

## **5. Explanation**

| Step | What Happens                                                      |
| ---- | ----------------------------------------------------------------- |
| 1    | You define `getWeather()` tool and describe its input schema.     |
| 2    | Gemini receives the prompt “What’s the weather in Delhi?”         |
| 3    | Gemini infers that it should call `getWeather(location="Delhi")`. |
| 4    | The SDK runs your JS function.                                    |
| 5    | Function output is passed back to Gemini.                         |
| 6    | Gemini uses it to produce the final human-readable answer.        |

---

## **6. Example – Multiple Tools**

You can define multiple tools in one array.

```js
const tools = [
  { name: "getWeather", ... },
  { name: "getTime", ... },
  { name: "calculate", ... },
];
```

Gemini will pick the correct tool dynamically.

---

## **7. Real-World Use Cases**

| Use Case        | Example                                     |
| --------------- | ------------------------------------------- |
| External API    | Fetch stock price, news, or weather         |
| Database Access | Retrieve user info                          |
| Calculator      | Perform math or logic operations            |
| Custom Workflow | Trigger email, Slack message, or automation |
| Agents          | Connect to external services dynamically    |

---

## **8. Notes for `/Topics OR Concepts/topic4/`**

**File:**
`01.tool-calling.md`

```
# Topic 4: Tool Calling (Function Calling)

- Tool Calling lets Gemini invoke developer-defined functions.
- Useful for:
  - Fetching real data
  - Running calculations
  - Integrating APIs
- Each tool:
  - Has a name, description, and parameter schema
  - Executes JS code
- Model decides when to use it based on prompt
- Result is fed back for final response

Example:
User: "What's the weather in Delhi?"
→ Gemini calls getWeather({ location: "Delhi" })
→ Returns real-time result
```

---

## **9. Practice Tasks**

1. Add another tool:

   ```js
   async function calculate({ a, b, operation }) {
     if (operation === "add") return a + b;
     if (operation === "multiply") return a * b;
   }
   ```

   Then ask:
   `"What is 23 multiplied by 7?"`

2. Try giving multiple tool options and see which one Gemini picks.

3. Log tool calls to the console to observe how Gemini reasons.

---

## **10. Summary**

You’ve now learned:

* What Tool Calling is and why it’s critical for agents
* How to define and register functions as tools
* How Gemini automatically selects and executes tools
* How this enables **real-world, action-taking AI agents**

---